###glusterfs脑裂


>裂脑：
裂脑是指文件的两个或多个复制副本变得不同的情况。当文件处于裂脑状态时，副本砖块中文件的数据或元数据不一致，并且没有足够的信息来权威地选择原始副本并修复坏副本，尽管所有砖块都已启动并联机。对于目录，还有一个条目拆分大脑，其中的文件可以在副本的砖块上具有不同的 gfid/文件类型。发生裂脑主要是因为两个原因：

* 由于网络断开连接，客户端暂时失去与brick的连接。
2副本，服务器 1 上的brick 1 和服务器 2 上的brick 2。
 由于网络拆分，客户端 1 失去与brick 2 的连接，客户端 2 失去与brick 1 的连接。
从客户端 1 写入到brick 1，从客户端 2 转到brick 2

* gluster进程下降或返回错误：
服务器 1 关闭，服务器 2 启动：写入发生在服务器 2 上。
服务器 1 启动，服务器 2 关闭（未发生修复/服务器 2 上的数据未在服务器 1 上复制）：写入发生在服务器 1 上。
服务器 2 启动：服务器 1 和服务器 2 都有彼此独立的数据。

**脑裂分为3种**
1. 数据脑裂：文件中的数据在副本组的brick中不同
2. 元数据脑裂：brick中元数据不同
3. GFID脑裂：副本brick上的文件GFID不同，或者副本上的文件类型不同，文件类型不同无法修复，GFID可以修复，GFID脑裂对外表现为目录脑裂